<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>- Data Acquisition System: The Sparker Wireless EEG Data Acquisition System</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="NASA-UON.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">- Data Acquisition System
   </div>
   <div id="projectbrief">Software for the Sparker Wireless EEG DAQ</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">The Sparker Wireless EEG Data Acquisition System </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><hr  />
<dl class="section author"><dt>Author</dt><dd>Sam Parker </dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.03</dd></dl>
<h1><a class="anchor" id="intro_sec"></a>
Introduction</h1>
<p>This is the software for the Sparker Wireless EEG Data Acquisition System. It was developed by Sam Parker as part of his Electrical Engineering Final Year Project at the University of Newcastle, Australia. This software contains interface functions to set-up, configure, and operate a Texas Instruments ADS1299 EEG Analog Front End device. It then pipes the data to a serial port (USB or Bluetooth).</p>
<h1><a class="anchor" id="mech"></a>
Mechanics</h1>
<p>The software is relatively simple. It instantiates a Pin_Map, which tells the device how the pins are mapped. If this software is being run on a board other than the Sparker Data Acquisition System, you need to check the Pin_Map is still correct. It then uses the Pin_Map to communicate with the ADS1299 over an SPI interface. The device is configured for the Sparker Data Acquisition board, so if it is to be used with a different recording montage, new data rate, etc. the setup process will need to be altered. Serial communications are managed by the Serial Module, which also has debug, warning, and error messages. These messages should only be used when send data over USB and you will need to check for the ID byte to distinguish between real data ana a message. If communicating over bluetooth, or these messages aren't desired, they can be switched off individually.</p>
<h1><a class="anchor" id="walkthrough"></a>
Walkthrough of the Read Process</h1>
<p>Assuming your device has been set up correctly (big assumption), the main loop checks to see if the device is running. At this point there is no way to start the device remotely (i.e. from the host serial device), but I might add this later if I think it is useful. If the device is running, the status LED will flash. The device will then poll the Data Ready pin until it goes low, when it issues the RDATA command, which sends 1 sample over the SPI interface. The sample ID bits are checked to make sure it's not corrupt, then it's processed and given a sequential sample ID. Sample IDs start at 1, and sample IDs of 0 mean the sample is invalid. But Sam, you say, doesn't that mean that when the Sample IDs overflow a good sample will be read as invalid? Yes it does. But the sample IDs won't overflow for 192 days of continuous recording, and if you're running this thing for 192 days you should use a better DAQ system. Valid samples are then sent over the serial interface (38400 baud) in the format (sample ID)(Channel 1)(Channel 2)(Channel 3) ...(Channel 8)(\n). Everything except the \n are uint32_ts in 8 data bits, no parity, 1 stop bit. Data is sent MSB first, most significant byte first. It then polls the Data Ready pin and starts again. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
