<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>- Data Acquisition System: Sparker_DAQ.ino File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="NASA-UON.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">- Data Acquisition System
   </div>
   <div id="projectbrief">Software for the Sparker Wireless EEG DAQ</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">Sparker_DAQ.ino File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The main file for the Sparker DAQ.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="_a_d_s1299_8h_source.html">ADS1299.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_d_a_q___pin___map_8h_source.html">DAQ_Pin_Map.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_serial___module_8h_source.html">Serial_Module.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a2610bbc06d9c0f6076c8069a9096ffe2"><td class="memItemLeft" align="right" valign="top">SoftwareSerial&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_sparker___d_a_q_8ino.html#a2610bbc06d9c0f6076c8069a9096ffe2">mySS</a> (8, 9)</td></tr>
<tr class="memdesc:a2610bbc06d9c0f6076c8069a9096ffe2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a UART interface for the Bluetooth Module, RX on 8, TX on 9.  <a href="_sparker___d_a_q_8ino.html#a2610bbc06d9c0f6076c8069a9096ffe2">More...</a><br /></td></tr>
<tr class="separator:a2610bbc06d9c0f6076c8069a9096ffe2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fc01d736fe50cf5b977f755b675f11d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_sparker___d_a_q_8ino.html#a4fc01d736fe50cf5b977f755b675f11d">setup</a> ()</td></tr>
<tr class="memdesc:a4fc01d736fe50cf5b977f755b675f11d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets up the ADS1299 and required interfaces.  <a href="_sparker___d_a_q_8ino.html#a4fc01d736fe50cf5b977f755b675f11d">More...</a><br /></td></tr>
<tr class="separator:a4fc01d736fe50cf5b977f755b675f11d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe461d27b9c48d5921c00d521181f12f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_sparker___d_a_q_8ino.html#afe461d27b9c48d5921c00d521181f12f">loop</a> ()</td></tr>
<tr class="memdesc:afe461d27b9c48d5921c00d521181f12f"><td class="mdescLeft">&#160;</td><td class="mdescRight">The main program loop.  <a href="_sparker___d_a_q_8ino.html#afe461d27b9c48d5921c00d521181f12f">More...</a><br /></td></tr>
<tr class="separator:afe461d27b9c48d5921c00d521181f12f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa965a8d884bdd29ff1f230f828d6ca6a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_sparker___d_a_q_8ino.html#aa965a8d884bdd29ff1f230f828d6ca6a">toggleLED</a> (uint16_t half_period, uint8_t debounce_ms)</td></tr>
<tr class="memdesc:aa965a8d884bdd29ff1f230f828d6ca6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flashes the Status LED pin at a given frequency.  <a href="_sparker___d_a_q_8ino.html#aa965a8d884bdd29ff1f230f828d6ca6a">More...</a><br /></td></tr>
<tr class="separator:aa965a8d884bdd29ff1f230f828d6ca6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1ffba7b30c314b6c6e4685b3575107e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_sample___data__t.html">Sample_Data_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_sparker___d_a_q_8ino.html#ae1ffba7b30c314b6c6e4685b3575107e">process_sample</a> (uint8_t *input_buffer)</td></tr>
<tr class="memdesc:ae1ffba7b30c314b6c6e4685b3575107e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes the input data buffer and parses it into a structure.  <a href="_sparker___d_a_q_8ino.html#ae1ffba7b30c314b6c6e4685b3575107e">More...</a><br /></td></tr>
<tr class="separator:ae1ffba7b30c314b6c6e4685b3575107e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe6da3a4d117b35233ba7953c06718dd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_sparker___d_a_q_8ino.html#afe6da3a4d117b35233ba7953c06718dd">check_register</a> (<a class="el" href="_a_d_s1299___params_8h.html#ac21547e38fb0ad7824bff2905c1b4f1f">Reg_ID_t</a> reg, uint8_t expected_value)</td></tr>
<tr class="memdesc:afe6da3a4d117b35233ba7953c06718dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compares the value reported by the ADS1299 to the expected value and prints the status on the Serial interface.  <a href="_sparker___d_a_q_8ino.html#afe6da3a4d117b35233ba7953c06718dd">More...</a><br /></td></tr>
<tr class="separator:afe6da3a4d117b35233ba7953c06718dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ad47faa3d261bb9d0a26749919cabb527"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_d_a_q___pin___map.html">DAQ_Pin_Map</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_sparker___d_a_q_8ino.html#ad47faa3d261bb9d0a26749919cabb527">Hardware_Map</a></td></tr>
<tr class="memdesc:ad47faa3d261bb9d0a26749919cabb527"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class stores information about how the MCU is connected to the ADC.  <a href="_sparker___d_a_q_8ino.html#ad47faa3d261bb9d0a26749919cabb527">More...</a><br /></td></tr>
<tr class="separator:ad47faa3d261bb9d0a26749919cabb527"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a201039bbe1eebd00d512a7b680af1f69"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_a_d_s1299___module.html">ADS1299_Module</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_sparker___d_a_q_8ino.html#a201039bbe1eebd00d512a7b680af1f69">ADS1299</a></td></tr>
<tr class="memdesc:a201039bbe1eebd00d512a7b680af1f69"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class enables communication with the ADC.  <a href="_sparker___d_a_q_8ino.html#a201039bbe1eebd00d512a7b680af1f69">More...</a><br /></td></tr>
<tr class="separator:a201039bbe1eebd00d512a7b680af1f69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10a9644158d26a3d8444fe12083cd3c3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_serial___module.html">Serial_Module</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_sparker___d_a_q_8ino.html#a10a9644158d26a3d8444fe12083cd3c3">Comms</a></td></tr>
<tr class="memdesc:a10a9644158d26a3d8444fe12083cd3c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class enables communication with the host device.  <a href="_sparker___d_a_q_8ino.html#a10a9644158d26a3d8444fe12083cd3c3">More...</a><br /></td></tr>
<tr class="separator:a10a9644158d26a3d8444fe12083cd3c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The main file for the Sparker DAQ. </p>
<hr  />
<p>Everything starts here. Gets the hardware info from the <a class="el" href="class_d_a_q___pin___map.html" title="The DAQ_Pin_Map class contains methods for interacting with the pins of the MCU.">DAQ_Pin_Map</a> class, and creates a <a class="el" href="class_a_d_s1299___module.html" title="The ADS1299_Module facilitates communication to and control of the ADC device.">ADS1299_Module</a> for working with the ADC. Also opens the UART connection for talking over USB or Bluetooth.</p>
<dl class="section author"><dt>Author</dt><dd>Sam Parker</dd></dl>
<p>Copyright (c) Sam Parker. 2020. All rights reserved. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="afe6da3a4d117b35233ba7953c06718dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe6da3a4d117b35233ba7953c06718dd">&#9670;&nbsp;</a></span>check_register()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void check_register </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_a_d_s1299___params_8h.html#ac21547e38fb0ad7824bff2905c1b4f1f">Reg_ID_t</a>&#160;</td>
          <td class="paramname"><em>reg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>expected_value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compares the value reported by the ADS1299 to the expected value and prints the status on the Serial interface. </p>
<hr  />
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">reg</td><td>- The register to compare </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">expected_value</td><td>- The value the user is expecting the register to return. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="afe461d27b9c48d5921c00d521181f12f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe461d27b9c48d5921c00d521181f12f">&#9670;&nbsp;</a></span>loop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void loop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The main program loop. </p>
<hr  />
<p> Plays all the jazz. </p>
<p>&lt; A buffer to save data from the ADC to</p>

</div>
</div>
<a id="a2610bbc06d9c0f6076c8069a9096ffe2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2610bbc06d9c0f6076c8069a9096ffe2">&#9670;&nbsp;</a></span>mySS()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SoftwareSerial mySS </td>
          <td>(</td>
          <td class="paramtype">8&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">9&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a UART interface for the Bluetooth Module, RX on 8, TX on 9. </p>

</div>
</div>
<a id="ae1ffba7b30c314b6c6e4685b3575107e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1ffba7b30c314b6c6e4685b3575107e">&#9670;&nbsp;</a></span>process_sample()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_sample___data__t.html">Sample_Data_t</a> process_sample </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>input_buffer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Processes the input data buffer and parses it into a structure. </p>
<hr  />
<p>Sample IDs start at 1. 0 is an invalid sample ID. This will overflow after 192 days of continuous recording.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">input_buffer</td><td>- The input data buffer from the ADC</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="struct_sample___data__t.html" title="This structure holds all the info to transmit for a single sample.">Sample_Data_t</a> - A structure containing the parsed data. All fields are 0 if error. </dd></dl>
<p>&lt; A running tally of samples</p>

</div>
</div>
<a id="a4fc01d736fe50cf5b977f755b675f11d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fc01d736fe50cf5b977f755b675f11d">&#9670;&nbsp;</a></span>setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets up the ADS1299 and required interfaces. </p>
<hr  />
 
</div>
</div>
<a id="aa965a8d884bdd29ff1f230f828d6ca6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa965a8d884bdd29ff1f230f828d6ca6a">&#9670;&nbsp;</a></span>toggleLED()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void toggleLED </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>half_period</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>debounce_ms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flashes the Status LED pin at a given frequency. </p>
<hr  />
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">half_period</td><td>- Half of the period (so the time the LED will be on / off for) in milliseconds. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">debounce_ms</td><td>- The time to wait between successive function calls. This is becuase the function may be called more than once a millisecond. Really, this value could be 1ms and everything will still be peachy. This way you can say 0ms and figure out how many times per ms the main loop runs by probing the status LED pin. </td></tr>
  </table>
  </dd>
</dl>
<p>&lt; The millisecond runtime that the LED was last toggled at</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a201039bbe1eebd00d512a7b680af1f69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a201039bbe1eebd00d512a7b680af1f69">&#9670;&nbsp;</a></span>ADS1299</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_a_d_s1299___module.html">ADS1299_Module</a>* ADS1299</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This class enables communication with the ADC. </p>

</div>
</div>
<a id="a10a9644158d26a3d8444fe12083cd3c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10a9644158d26a3d8444fe12083cd3c3">&#9670;&nbsp;</a></span>Comms</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_serial___module.html">Serial_Module</a>* Comms</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This class enables communication with the host device. </p>

</div>
</div>
<a id="ad47faa3d261bb9d0a26749919cabb527"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad47faa3d261bb9d0a26749919cabb527">&#9670;&nbsp;</a></span>Hardware_Map</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_d_a_q___pin___map.html">DAQ_Pin_Map</a>* Hardware_Map</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This class stores information about how the MCU is connected to the ADC. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
